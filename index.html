<!DOCTYPE html>
<html lang="eng">
<head>
  <meta charset="UTF-8" />
  <title>GABWEBGFX</title>
  <link rel="shortcut icon" type="image/x-icon" href="/Home/homeFavicon.ico" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.2.0/remixicon.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: "Segoe UI", sans-serif;
    }

    body {
      height: 100vh;
      overflow: hidden;
      background: #020617;
    }

    header {
      position: absolute;
      top: 32px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
      transition: opacity 0.6s ease, transform 0.6s ease;
    }

    header.fade-out {
      opacity: 0;
      transform: scale(0.95);
    }

    .center-nav ul {
      list-style: none;
      display: flex;
      gap: 48px;
    }

    .center-nav a {
      position: relative;
      text-decoration: none;
      color: #e5e7eb;
      font-size: 22px;
      letter-spacing: 1px;
      padding-bottom: 8px;
      cursor: pointer;
    }

    .center-nav a::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: 0;
      height: 2px;
      width: 0;
      background: #6366f1;
      transition: width 0.3s ease;
    }

    .center-nav a:hover::after,
    .center-nav a.active::after {
      width: 100%;
    }

    main {
      position: absolute;
      inset: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      z-index: 5;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.6s ease;
    }

    main.visible {
      opacity: 1;
    }

    .page {
      text-align: center;
      max-width: 600px;
      line-height: 1.6;
      font-size: 20px;
    }

    canvas {
      display: block;
      pointer-events: none;
    }

    body {
      margin: 0;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }

    .hero {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      z-index: 10;
      color: white;
    }

    .hero h1 {
      font-size: 64px;
      font-weight: 800;
      letter-spacing: 4px;
      margin-bottom: 30px;
    }

    .buttons {
      display: flex;
      gap: 20px;
      justify-content: center;
    }

    .btn {
      padding: 12px 28px;
      background: #6366f1;
      border-radius: 8px;
      text-decoration: none;
      color: white;
      font-weight: 600;
      transition: 0.3s;
    }

    .btn:hover {
      background: #4f46e5;
      transform: translateY(-3px);
    }

    .btn.secondary {
      background: transparent;
      border: 2px solid #6366f1;
    }
  </style>
</head>
<body>

<header id="header">
  <nav class="center-nav">
    <ul>
      <li><a data-page="home" class="active">Home</a></li>
      <li><a data-page="viewer">Model viewer</a></li>
      <li><a data-page="visualizer">Music visualizer</a></li>
      <li><a data-page="tetris">Tetris</a></li>
    </ul>
  </nav>
</header>

<main id="content"></main>

<div class="hero">
  <h1>GABWEBGFX</h1>
  <div class="buttons">
    <a href="https://github.com/Gabrax" target="_blank" class="btn secondary"><i class="fa-brands fa-github"></i></a>
    <a href="https://www.linkedin.com/in/gabriel-ozeg/" target="_blank" class="btn secondary"> <i class="fa-brands fa-linkedin-in"></i></a>
  </div>
</div>

<script type="module" lang="ts">
import * as THREE from "https://unpkg.com/three@0.160.0/build/three.module.js";

import { ModelViewer } from "/model_viewer/model_viewer.ts";
import { MusicVisualizerPlayer } from "/music_visualizer/music_visualizer.ts";
import { Tetris } from "/tetris/tetrisGame.ts";
let viewer;
let musicApp;
let game;

const scene = new THREE.Scene();
scene.background = new THREE.Color(0x020617);

const camera = new THREE.PerspectiveCamera(
  60,
  window.innerWidth / window.innerHeight,
  0.1,
  100
);
camera.position.z = 4;

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

const mesh = new THREE.Mesh(
  new THREE.IcosahedronGeometry(1.3, 1),
  new THREE.MeshStandardMaterial({
    color: 0x6366f1, metalness: 0.6, roughness: 0.2
  })
);

const torus = new THREE.Mesh(
  new THREE.TorusKnotGeometry( 10.887, 0.8712, 64, 15, 15, 11 ),
  new THREE.MeshStandardMaterial({
    color: 0x8b5cf6,
    metalness: 0.9,
    roughness: 0.15,
    wireframe: true
  })
);

torus.position.set(0, 0, 0);
torus.scale.set(0.1,0.1,0.1);
scene.add(torus);

const loader = new THREE.CubeTextureLoader();
const texture = loader.load([
  '/Home/NightSky_Right.png', // +X
  '/Home/NightSky_Left.png', // -X
  '/Home/NightSky_Top.png', // +Y
  '/Home/NightSky_Bottom.png', // -Y
  '/Home/NightSky_Front.png', // +Z
  '/Home/NightSky_Back.png', // -Z
]);
scene.background = texture;

scene.add(new THREE.AmbientLight(0xffffff, 0.6));
const light = new THREE.PointLight(0xffffff, 1);
light.position.set(5, 5, 5);
scene.add(light);

async function animate()
{
  camera.position.x = Math.sin(Date.now() * 0.0001) * 4;
  camera.position.z = Math.cos(Date.now() * 0.0001) * 4;
  camera.lookAt(0, 0, 0);

  torus.rotation.x += 0.001;
  torus.rotation.y += 0.0015;

  renderer.render(scene, camera);
  requestAnimationFrame(animate);
}
animate();

const pages =
{
  home: ``,
  viewer: `/model_viewer/model_viewer.html`,
  visualizer: `/music_visualizer/music_visualizer.html`,
  tetris: `/tetris/tetrisGame.html`
};

const content = document.getElementById("content");
const links = document.querySelectorAll("[data-page]");

async function loadPage(name) {
  content.classList.remove("visible");

  links.forEach(l => l.classList.remove("active"));
  document.querySelector(`[data-page="${name}"]`)?.classList.add("active");

  setTimeout(async () => {
    const url = pages[name];
    if (!url) return;

    try {
      const res = await fetch(url);
      const html = await res.text();
      content.innerHTML = html;
      content.classList.add("visible");
        
      if (name === "viewer") viewer = new ModelViewer();
      else if (name === "visualizer") musicApp = new MusicVisualizerPlayer();
      else if(name === "tetris") game = new Tetris(10,20,40);
      else
      {
        viewer = undefined;
        musicApp = undefined;
        game = undefined;
      }

    } catch (err) {
      console.log(err);
      content.innerHTML = "<p>Error loading page</p>";
    }
  }, 300);
}

window.addEventListener("resize", () => {
  const width = window.innerWidth;
  const height = window.innerHeight;

  camera.aspect = width / height;
  camera.updateProjectionMatrix();

  renderer.setSize(width, height);
  renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
});

links.forEach(link =>
{
  link.addEventListener("click", () =>
  {
    loadPage(link.dataset.page);
  });
});

loadPage("home");
</script>

</body>
</html>
